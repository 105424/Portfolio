{"ts":1354624025771,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"$(document).ready(init);\r\nvar width;\r\nvar height;\r\nvar mouseX;\r\nvar mouseY;\r\nvar mouseAtBorder = false;\r\nvar border = 'none';\r\nvar borderLock = false;\r\nvar config = config;\r\n\r\nfunction init()\r\n{        \r\n    console.log('--init--');\r\n    \r\n    width = $(window).width();\r\n    height = $(window).height(); \r\n    \r\n    window.onresize=function()\r\n    {\r\n        console.log('resize')\r\n        width = $(window).width();\r\n        height = $(window).height();\r\n        for(var i in divs){divs[i].update()}\r\n    };\r\n    \r\n    if (typeof config != 'undefined') parseDivs(config); // deze variable zit in config.js\r\n    else console.log('config not found');\r\n    \r\n//    $('.mini').live('click', mini);\r\n//    $('.titleMini').live('click', reverse);\r\n    $('html').live('mousemove', mouseTrace);        // zorgt ervoor dat de muis op het juiste moment van sprite verandert.\r\n    $('.movable').live('mousedown', mouseDown);     // zorgt voor het resize/verplaatsen van de div's\r\n    $('#save').live('click', save);                 // de save functie die het object met de cordinaten gaat opslaan;\r\n    $('#load').live('click', load );                // de save functie die het object met de cordinaten gaat opslaan;    \r\n    \r\n    sideMenu(); // de code van het zij menutje zoveel de animatie als de positionering (jammer genoeg kreeg ik dit niet in css voor elkaar);\r\n    \r\n    console.log(divs);\r\n //   load();\r\n}\r\nfunction reverse(event)\r\n{\r\n    var _target = divs[$(this).parent().attr(\"id\")];\r\n    var _dom = _target.dom;   \r\n    $(_dom).children().show();\r\n    $(_dom).children('p').remove();\r\n    $(_dom).attr('class', 'movable')\r\n    $(_dom).animate({\r\n        height: '450px',\r\n        width:  '1000px'\r\n    }, 1000, function() {\r\n        _target.height = (height/100)*450;\r\n        _target.width = (width/100)*1000;\r\n    });\r\n}\r\nfunction mini(event)\r\n{\r\n    var _target = divs[$(this).parent().attr(\"id\")];\r\n    var _dom = _target.dom;\r\n    console.log(_dom);\r\n    $(_dom).animate({\r\n        height: '20px',\r\n        width:  '100px',\r\n        left: '-='+(width/100)*_target.x\r\n    }, 1000, function() {\r\n        _target.height = (height/100)*20;\r\n        _target.width = (width/100)*100;\r\n        _target.x = 0;\r\n        $(_dom).children().hide();\r\n        $(_dom).append('<p class=\"titleMini\">'+_target.titleMini+'</p>');\r\n        $(_dom).removeAttr('class');\r\n    });\r\n}\r\nfunction mouseTrace(event)\r\n{\r\n    mouseX = event.clientX;\r\n    mouseY = event.clientY;\r\n    if(mouseAtBorder === true)\r\n    {\r\n        $('body').css('cursor','auto');\r\n        $('body>*').css('cursor','auto');\r\n        mouseAtBorder = false;\r\n    }\r\n    for(var i in divs)\r\n    {          \r\n        var target = divs[i];     \r\n        var _x = (width/100)*target.x;\r\n        var _y = (height/100)*target.y;\r\n        var _width = (width/100)*target.width+target.padHorz;\r\n        var _height = (height/100)*target.height+target.padVert;\r\n\r\n        if(mouseX>_x-1 && mouseX<_x+4 && mouseY>_y && mouseY<_y+_height)\r\n        {\r\n            //left\r\n            $('body>*').css('cursor','e-resize');\r\n            $('body').css('cursor','e-resize');\r\n            mouseAtBorder = true;\r\n            if(borderLock === true)return;\r\n            border = 'left';\r\n        }\r\n        if(mouseX>_x+_width-1 && mouseX<_x+_width+6 && mouseY>_y && mouseY<_y+_height)\r\n        {      \r\n            //right\r\n            $('body>*').css('cursor','e-resize');\r\n            $('body').css('cursor','e-resize');\r\n            mouseAtBorder = true;\r\n            if(borderLock === true)return;\r\n            border = 'right';\r\n        }\r\n        if(mouseX>_x && mouseX<_x+_width && mouseY>_y-2 && mouseY<_y+2)\r\n        {\r\n            //top\r\n            $('body>*').css('cursor','s-resize');\r\n            $('body').css('cursor','s-resize');\r\n            mouseAtBorder = true;\r\n            if(borderLock === true)return;\r\n            border = 'top';\r\n        }\r\n        if(mouseX>_x && mouseX<_x+_width && mouseY>_y+_height-2 && mouseY<_y+_height+2)\r\n        {\r\n            //bottom\r\n            $('body>*').css('cursor','s-resize');\r\n            $('body').css('cursor','s-resize');   \r\n            mouseAtBorder = true;\r\n            if(borderLock === true)return;\r\n            border = 'bottom';\r\n        }\r\n    }   \r\n}\r\nfunction mouseDown(event)\r\n{\r\n    console.log('----mouseDown----');\r\n    \r\n    var type = $(this).attr('id');\r\n    var target = divs[type];   \r\n    console.log('target: '+type);\r\n    if(target.z != 1000)\r\n    {\r\n        target.z = 1000+1;\r\n        for(var i in divs)\r\n        {\r\n            divs[i].z -= 1;\r\n            divs[i].update();\r\n        }\r\n    }    \r\n    console.log('Z: '+target.z);\r\n    \r\n    if(mouseAtBorder===true)\r\n    {\r\n        console.log('   --rezise '+border+'--');   \r\n        var xRight = (width/100)*target.x + (width/100)*target.width;\r\n        var yBottom = (height/100)*target.y + (height/100)*target.height;\r\n        borderLock = true;\r\n        $('html').bind('mousemove',function(event){\r\n            if(mouseY > height-10)\r\n            {\r\n                console.log(\"mouseY: \" +mouseY)\r\n                mouseY = height-10;\r\n            }\r\n            if(mouseY < 37)\r\n            {\r\n                console.log(\"mouseY: \" +mouseY)\r\n                mouseY = 37;   \r\n            }\r\n            \r\n            if(border =='left' || border=='right')\r\n            {\r\n                $('body>*').css('cursor','e-resize');\r\n                $('body').css('cursor','e-resize');\r\n                if(border=='left')\r\n                {\r\n                    target.x = 100/(width/mouseX); \r\n                    target.width = 100/(width/(xRight - mouseX));   \r\n                }\r\n                if(border=='right') target.width = 100/(width/(mouseX - (width/100)*target.x - target.padHorz));\r\n            }\r\n            if(border=='top' || border=='bottom')\r\n            {\r\n                $('body>*').css('cursor','s-resize');\r\n                $('body').css('cursor','s-resize');      \r\n                \r\n                if(border=='top')\r\n                {\r\n                   target.y = 100/(height/mouseY);\r\n                   target.height = 100/(height/(yBottom - mouseY));\r\n                }\r\n                if(border=='bottom') target.height = 100/(height/(mouseY - (height/100)*target.y - target.padVert));\r\n            } \r\n            target.update();\r\n        });\r\n        \r\n        $('html').mouseup(function(event){\r\n            borderLock = false;\r\n            $('body>*').css('cursor','auto');\r\n            $('body').css('cursor','auto');\r\n            $('html').unbind('mousemove'); \r\n        });     \r\n    }\r\n    else\r\n    {          \r\n        var xOffSet = event.clientX-((width/100)*target.x);  //cordinates of space between mousey and y of the div\r\n        var yOffSet = event.clientY-((height/100)*target.y); //cordinates of space between mousec and c of the div\r\n        \r\n        console.log('   --startMove--');\r\n        console.log('       target.x: '+target.x);\r\n        console.log('       target.y: '+target.y);\r\n        console.log('       event.x: '+event.clientX);\r\n        console.log('       event.y: '+event.clientY);\r\n        console.log('       ofset.x: '+xOffSet);\r\n        console.log('       offset.y: '+yOffSet); \r\n        \r\n        $('body>*').css('cursor','move');\r\n        $('body').css('cursor','move');\r\n        $('html').bind('mousemove',function(event){        \r\n            \r\n            target.x = 100/(width/(event.pageX-xOffSet));\r\n            target.y = 100/(height/(event.pageY-yOffSet));\r\n            \r\n            if((height/100)*target.y<37) target.y = 100/(height/37);\r\n            if(target.x<0) target.x = 0;\r\n            if((height/100)*target.y>(height-(height/100)*target.height-10-target.padVert)) target.y = 100/(height/(height-(height/100)*target.height-10-target.padVert));\r\n            if((width/100)*target.x>(width-(width/100)*target.width-target.padHorz)) target.x = 100/(width/(width-(width/100)*target.width-target.padHorz));\r\n            \r\n            target.update();\r\n        });\r\n        \r\n        $('html').mouseup(function(event){\r\n            $('body').css('cursor','auto');\r\n            $('body>*').css('cursor','auto');\r\n            $('html').unbind('mousemove'); \r\n        });\r\n    }\r\n}\r\nvar div = function(type,cordinates)\r\n{\r\n    console.log('----div: '+type+'----');\r\n    console.log($('body').find('#'+type)[0]);\r\n    if($('body').find('#'+type)[0]===undefined) \r\n    {\r\n        console.log('   div does not exist');\r\n        delete divs[type];\r\n        console.log(divs);\r\n        return;\r\n    }\r\n    this.titleMini = type;\r\n    this.dom = $('body').find('#'+type);\r\n    console.log(width);\r\n    this.width = 100/(width/$(this.dom).width());\r\n    this.height = 100/(height/$(this.dom).height());\r\n    this.padHorz = parseInt($(this.dom).css(\"padding-right\")) + parseInt($(this.dom).css(\"padding-left\"));\r\n    this.padVert = parseInt($(this.dom).css(\"padding-top\")) + parseInt($(this.dom).css(\"padding-bottom\"));\r\n    this.z='auto';\r\n    \r\n    if(cordinates==='')\r\n    {\r\n        console.log('   no preset');\r\n        console.log('   off-top: '+$(this.dom).offset().top);\r\n        console.log('   off-left: '+$(this.dom).offset().left);\r\n        \r\n        \r\n        this.x = 100/(width/$(this.dom).offset().left);\r\n        this.y = 100/(height/$(this.dom).offset().top);\r\n    }\r\n    else\r\n    { ///wordt niet meer gebrukt als functionalitiet\r\n        console.log('   cordinates defined');\r\n        \r\n        var cords = cordinates.split(',');\r\n        \r\n        console.log('   split:'+cords); \r\n        \r\n        if(isNaN(Number(cords[0]))===false) this.x = Number(cords[0]);\r\n        if(isNaN(Number(cords[1]))===false) this.y = Number(cords[1]);\r\n        if(isNaN(Number(cords[2]))===false) this.width = Number(cords[2]);\r\n        if(isNaN(Number(cords[3]))===false) this.height = Number(cords[3]);\r\n        if(isNaN(Number(cords[4]))===false) this.z = Number(cords[4]);\r\n    }\r\n    if($(this.dom).hasClass('movable')===false)\r\n    {\r\n        console.log('   re-place');\r\n        \r\n        $(this.dom).remove();\r\n        $('body').append(this.dom);\r\n        $(this.dom).addClass('movable');\r\n    }\r\n    \r\n    $(this.dom).append('<span class=\"mini\">mini</span>');\r\n    \r\n    console.log('this.x:'+this.x);\r\n    console.log('this.y:'+this.y);\r\n \r\n    this.update();\r\n    \r\n    console.log(\"width: \"+this.width);\r\n    console.log(\"height: \"+this.height); \r\n    console.log($('body').find('#'+type)[0]);\r\n};\r\ndiv.prototype.update = function()\r\n{\r\n    console.log('update()');\r\n    $(this.dom).css('top',(height/100)*this.y);\r\n    $(this.dom).css('left',(width/100)*this.x);\r\n    $(this.dom).css('width',(width/100)*this.width);\r\n    $(this.dom).css('height',(height/100)*this.height);\r\n    $(this.dom).css('z-index',this.z);\r\n};\r\n\r\nvar divs = {};\r\nfunction parseDivs(toParse)\r\n{\r\n    console.log('-----toPare------');\r\n    for(var type in toParse)\r\n    {\r\n        divs[type] = new div(type,toParse[type]);\r\n    }    \r\n}\r\nfunction save(event)\r\n{   \r\n    console.log('---save----');\r\n    var _save = {};\r\n    \r\n    for(var i in divs)\r\n    {\r\n        _save[i] = divs[i].x+','+divs[i].y+','+divs[i].width+','+divs[i].height+','+divs[i].z;\r\n    }\r\n    console.log(_save);\r\n    localStorage.setItem('save', JSON.stringify(_save));\r\n}\r\nfunction load(event)\r\n{\r\n    console.log('----load----');\r\n    var _load = JSON.parse(localStorage.getItem('save'));\r\n    \r\n    if(_load ===null) return;\r\n \r\n \r\n    parseDivs(_load);\r\n}\r\nfunction sideMenu()\r\n{\r\n    var dom = $('body').find('#sideMenu');\r\n    var top = (height/2)-$(dom).height()+$('#topBar').height();\r\n    var left = (width)-$(dom).width();\r\n    var mWidth = $('#sideMenu').width()+2;\r\n    var offSet = mWidth;\r\n    \r\n    $('#sideMenuToggle').css('right', $('#sideMenu').width());\r\n    \r\n    $('#sideMenuToggle').click(function(){\r\n        console.log('sideMenuToggle Click');\r\n        if(offSet==mWidth)\r\n        {\r\n            console.log('offset=72');\r\n            var temp = setInterval(function(){\r\n                offSet -= 2;\r\n                if(offSet===0) clearInterval(temp);\r\n            },10);\r\n        }\r\n        if(offSet===0)\r\n        {\r\n            var temp2 = setInterval(function(){\r\n                offSet += 2;\r\n                if(offSet==mWidth) clearInterval(temp2);\r\n            },10);            \r\n        }\r\n    });\r\n    \r\n    setInterval(function(){   \r\n        top = (height/2)-$(dom).height()+$('#topBar').height()+37; //37 is de hoogte van de header bar\r\n        left = (width)-$(dom).width()+offSet; // \r\n        $(dom).css('top', top);\r\n        $(dom).css('left', left);\r\n    },10);\r\n    \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":12694}]],"length":12694}
